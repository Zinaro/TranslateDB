{% include 'lib/header.html' %}

<div class="container-fluid pt-4 px-4">
    <div class="row g-4">
        <div class="col-md-12">
            <div class="bg-secondary rounded h-100 p-4">
                <h6 class="mb-4">File Uploading and Processing</h6>
                <form id="uploadForm" enctype="multipart/form-data">
                    <div class="mb-3">
                        <label for="fileInput" class="form-label">Select a file:</label>
                        <input class="form-control" type="file" id="fileInput" name="file">
                    </div>
                    <button type="button" class="btn btn-primary" id="uploadBtn">Upload File</button>
                </form>
            </div>
        </div>
        <!-- Translations Table -->
        <div class="col-sm-12">
            <div class="bg-secondary rounded h-100 p-4">
                <div class="d-flex justify-content-between align-items-center">
                    <h6 class="mb-4">Translations</h6>
                    <div class="d-flex">
                        <select id="rows-per-page" class="form-select form-select-sm me-2">
                            <option value="10" selected>10</option>
                            <option value="20">20</option>
                            <option value="50">50</option>
                            <option value="100">100</option>
                            <option value="200">200</option>
                        </select>
                        <nav>
                            <ul class="pagination pagination-sm mb-0" id="pagination-top"></ul>
                        </nav>
                    </div>
                </div>
                <table class="table table-hover align-middle">
                    <thead>
                        <tr>
                            <th scope="col">English</th>
                            <th scope="col">Kurdish</th>
                            <th scope="col" class="text-center" style="width: 260px;">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="translations-body">
                    </tbody>
                </table>
                <div class="d-flex justify-content-between align-items-center">
                    <h6 class="mb-4">Translations</h6>
                    <div class="d-flex">
                        <nav>
                            <ul class="pagination pagination-sm mb-0" id="pagination-bottom"></ul>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.getElementById("uploadBtn").addEventListener("click", function() {
        const fileInput = document.getElementById("fileInput");
        
        if (fileInput.files.length === 0) {
            alert("Please select a file!");
            return;
        }

        const formData = new FormData();
        formData.append("file", fileInput.files[0]);
        
        fetch("/work/upload", {
            method: "POST",
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            alert(data.message);
        })
        .catch(error => {
            alert("Error: " + error.message);
        });
    });

    function loadTranslations() {
        const translations = [
            { english: "Hello", kurdish: "Slav" },
            { english: "Thank you", kurdish: "Spas" }
        ];
        
        const tbody = document.getElementById("translations-body");
        tbody.innerHTML = "";
        
        translations.forEach((translation, index) => {
            const row = document.createElement("tr");
            
            row.innerHTML = `
                <td><span class="editable" data-index="${index}" data-field="english">${translation.english}</span></td>
                <td><span class="editable" data-index="${index}" data-field="kurdish">${translation.kurdish}</span></td>
                <td class="text-center">
                    <button class="btn btn-sm btn-warning edit-btn">Edit</button>
                    <button class="btn btn-sm btn-success accept-btn">Accept</button>
                    <button class="btn btn-sm btn-danger reject-btn">Reject</button>
                </td>
            `;
            
            tbody.appendChild(row);
        });
    }
    
    document.addEventListener("DOMContentLoaded", function() {
        loadTranslations();
        
        document.getElementById("translations-body").addEventListener("click", function(event) {
            if (event.target.classList.contains("edit-btn")) {
                const row = event.target.closest("tr");
                const englishCell = row.children[0];
                const kurdishCell = row.children[1];
                
                englishCell.innerHTML = `<input type="text" class="form-control" value="${englishCell.textContent.trim()}">`;
                kurdishCell.innerHTML = `<input type="text" class="form-control" value="${kurdishCell.textContent.trim()}">`;
                
                event.target.textContent = "Save";
                event.target.classList.remove("edit-btn");
                event.target.classList.add("save-btn");
            } else if (event.target.classList.contains("save-btn")) {
                const row = event.target.closest("tr");
                const englishInput = row.children[0].querySelector("input");
                const kurdishInput = row.children[1].querySelector("input");
                
                row.children[0].innerHTML = `<span class="editable">${englishInput.value}</span>`;
                row.children[1].innerHTML = `<span class="editable">${kurdishInput.value}</span>`;
                
                event.target.textContent = "Edit";
                event.target.classList.remove("save-btn");
                event.target.classList.add("edit-btn");
            }
        });
    });
</script>

{% include 'lib/footer.html' %}